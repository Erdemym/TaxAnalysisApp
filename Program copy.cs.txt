using System;
using System.Data;
using System.Data.OleDb;

class Program1
{
    static void Main()
    {
       string connectionString="";

        using (OleDbConnection connection = new OleDbConnection(connectionString))
        {
            connection.Open();

            // SQL query to select data from the Excel file
            string query = "SELECT * FROM [sbk$] WHERE [Yil] = 2018";

            using (OleDbCommand command = new OleDbCommand(query, connection))
            using (OleDbDataAdapter adapter = new OleDbDataAdapter(command))
            {
                DataTable dataTable = new DataTable();
                adapter.Fill(dataTable);

                // Display the results
                foreach (DataRow row in dataTable.Rows)
                {
                    //filling the data into SBK class with convert Belge to integer
                    SBK data = new SBK
                    {
                        VKN = row["VKN"].ToString(),
                        Unvan = row["Unvan"].ToString(),
                        Yil = Convert.ToInt32(row["Yil"]),
                        Tutar = Convert.ToDecimal(row["Tutar"]),
                        Belge = Convert.ToInt32(row["Belge"]),
                        Tablo = row["Tablo"].ToString(),
                        EkBilgi = row["EkBilgi"].ToString()
                    };

                    Console.Write("VKN: " + data.VKN + "\t");
               
                    
                }
            }
        }
    }
}
